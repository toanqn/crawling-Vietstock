__author__ = 'toanqn'

import scrapy, re

class VietStock(scrapy.Spider):
    name = 'vietstock'
    allowed_domains = ['finance.vietstock.vn']
    start_urls = [
        "http://finance.vietstock.vn/doanh-nghiep-a-z/"
    ]
    base_url = 'http://finance.vietstock.vn/Controls/Report/Data/GetReport.ashx?rptType=BCTT&scode={}&bizType=1&rptUnit=1000&rptTermTypeID=1&page={}'

    def parse(self, response):
        macps = ['AAA','AAM','ABC','ABI','ABT','AC4','ACB','ACC','ACE','ACL','ACM','ACS','ACV','ADC','ADP','ADS','AFC','AFX','AG1','AGF','AGM','AGP','AGR','AGX','ALT','ALV','AMC','AMD','AME','AMP','AMS','AMV','ANT','ANV','APC','APF','APG','API','APL','APP','APS','ARM','ART','ASA','ASD','ASM','ASP','AST','ATA','ATB','ATG','ATS','AUM','AVC','AVF','B82','BAB','BAL','BAX','BBC','BBM','BBS','BCC','BCE','BCG','BCM','BCP','BDB','BDF','BDG','BDP','BDT','BDW','BED','BEL','BFC','BGM','BGW','BHA','BHC','BHN','BHP','BHT','BHV','BIC','BID','BII','BKC','BLF','BLI','BLN','BLT','BMC','BMD','BMI','BMJ','BMN','BMP','BMV','BPC','BPW','BQB','BRC','BRR','BRS','BSC','BSD','BSG','BSI','BSL','BSP','BSQ','BSR','BST','BT1','BT6','BTB','BTC','BTD','BTG','BTH','BTN','BTP','BTR','BTS','BTT','BTU','BTV','BTW','BUD','BVG','BVH','BVN','BVS','BWA','BWE','BWS','BXH','C12','C21','C32','C36','C47','C69','C71','C92','CAD','CAG','CAN','CAP','CAT','CAV','CBI','CBS','CC1','CC4','CCH','CCI','CCL','CCM','CCP','CCR','CCT','CCV','CDC','CDG','CDH','CDN','CDO','CDR','CE1','CEC','CEE','CEG','CEO','CER','CET','CFC','CGP','CGV','CH5','CHC','CHP','CHS','CI5','CIA','CID','CIG','CII','CIP','CJC','CKD','CKH','CKV','CLC','CLG','CLH','CLL','CLM','CLW','CLX','CMC','CMF','CMG','CMI','CMK','CMN','CMP','CMS','CMT','CMV','CMW','CMX','CNC','CNG','CNH','CNN','CNT','COM','CPC','CPH','CPI','CQT','CSC','CSM','CSV','CT3','CT6','CTA','CTB','CTC','CTD','CTF','CTG','CTI','CTN','CTP','CTR','CTS','CTT','CTW','CTX','CVC','CVH','CVN','CVT','CX8','CXH','CYC','CZC','D11','D2D','DAC','DAD','DAE','DAG','DAH','DAP','DAR','DAS','DAT','DBC','DBD','DBH','DBM','DBT','DBW','DC1','DC2','DC4','DCD','DCF','DCI','DCL','DCM','DCS','DCT','DDH','DDM','DDN','DDV','DFC','DGC','DGL','DGT','DGW','DHA','DHB','DHC','DHD','DHG','DHM','DHP','DHT','DIC','DID','DIG','DIH','DL1','DLD','DLG','DLR','DLT','DMC','DNA','DNC','DND','DNE','DNH','DNL','DNM','DNN','DNP','DNR','DNS','DNW','DNY','DOC','DOP','DP2','DP3','DPC','DPG','DPH','DPM','DPP','DPR','DPS','DQC','DRC','DRH','DRI','DRL','DS3','DSC','DSG','DSN','DSS','DST','DSV','DT4','DTA','DTC','DTD','DTG','DTI','DTK','DTL','DTN','DTT','DTV','DVC','DVH','DVN','DVP','DXG','DXL','DXP','DXV','DZM','E1VFVN30','EAD','EBS','ECI','EFI','EIB','EIC','EID','EIN','ELC','EMC','EME','EMG','EMS','EPH','EVE','EVG','FBA','FBC','FCC','FCM','FCN','FCS','FDC','FDG','FDT','FHN','FID','FIT','FLC','FMC','FOX','FPT','FRM','FSC','FSO','FT1','FTI','FTM','FTS','FUCTVGF1','FUCVREIT','FUESSV50','G20','G36','GAS','GCB','GDT','GDW','GEG','GER','GEX','GGG','GGS','GHC','GIL','GKM','GLT','GLW','GMC','GMD','GMX','GND','GSM','GSP','GTA','GTC','GTD','GTH','GTN','GTS','GTT','GVR','GVT','H11','HAB','HAC','HAD','HAF','HAG','HAH','HAI','HAM','HAN','HAP','HAR','HAS','HAT','HAV','HAX','HBC','HBD','HBE','HBH','HBS','HC3','HCC','HCD','HCI','HCM','HCS','HCT','HD2','HDA','HDB','HDC','HDG','HDM','HDO','HDP','HDW','HEC','HEJ','HEM','HEP','HES','HEV','HFB','HFC','HFS','HFT','HFX','HGM','HGW','HHA','HHC','HHG','HHN','HHR','HHS','HHV','HID','HIG','HII','HJC','HJS','HKB','HKP','HKT','HLA','HLB','HLC','HLD','HLE','HLG','HLR','HLS','HLY','HMC','HMG','HMH','HMS','HNA','HNB','HND','HNF','HNG','HNI','HNM','HNP','HNT','HOM','HOT','HPB','HPD','HPG','HPH','HPI','HPM','HPP','HPT','HPU','HPW','HQC','HRB','HRC','HRG','HRT','HSA','HSG','HSI','HST','HT1','HTC','HTE','HTG','HTI','HTL','HTP','HTR','HTT','HTU','HTV','HTW','HU1','HU3','HU4','HU6','HUG','HUT','HVA','HVG','HVN','HVT','HVX','I10','IBC','ICC','ICF','ICG','ICI','ICN','IDC','IDI','IDJ','IDN','IDV','IFC','IFS','IHK','IJC','IKH','ILA','ILS','IME','IMP','IN4','INC','INN','IPA','IRC','ISG','ISH','IST','ITA','ITC','ITD','ITQ','ITS','IVS','JOS','JVC','KAC','KBC','KBE','KCB','KCE','KDC','KDF','KDH','KDM','KGM','KGU','KHA','KHB','KHD','KHL','KHP','KHS','KHW','KIP','KKC','KLB','KLF','KMR','KMT','KOS','KPF','KSA','KSB','KSD','KSE','KSH','KSK','KSQ','KST','KSV','KTB','KTL','KTS','KTT','KTU','KVC','L10','L12','L14','L18','L35','L43','L44','L45','L61','L62','L63','LAF','LAI','LAS','LAW','LBC','LBE','LBM','LCC','LCD','LCG','LCM','LCS','LCW','LDG','LDP','LDW','LEC','LG9','LGC','LGL','LHC','LHG','LIC','LIG','LIX','LKW','LLM','LM3','LM7','LM8','LMC','LMI','LO5','LPB','LQN','LSS','LTC','LTG','LUT','LWS','M10','MAC','MAS','MBB','MBG','MBS','MC3','MCC','MCF','MCG','MCH','MCI','MCO','MCP','MCT','MDA','MDC','MDF','MDG','MEC','MEF','MEL','MES','MFS','MGC','MGG','MH3','MHC','MHL','MIC','MIE','MIG','MIM','MKP','MKV','MLC','MLN','MLS','MMC','MNC','MND','MPC','MPT','MPY','MQB','MRF','MSC','MSN','MSR','MST','MTA','MTC','MTG','MTH','MTL','MTM','MTP','MTS','MTV','MVB','MVC','MVY','MWG','NAC','NAF','NAG','NAP','NAS','NAV','NAW','NBB','NBC','NBE','NBP','NBR','NBT','NBW','NCP','NCS','NCT','ND2','NDC','NDF','NDN','NDP','NDX','NED','NET','NFC','NGC','NHA','NHC','NHH','NHP','NHT','NHV','NKG','NLG','NLS','NMK','NNB','NNC','NNG','NNT','NOS','NPH','NPS','NQB','NQT','NRC','NS2','NS3','NSC','NSG','NSH','NST','NT2','NTB','NTC','NTL','NTP','NTR','NTT','NTW','NUE','NVB','NVL','NVP','NVT','NWT','OCH','OGC','OIL','ONE','ONW','OPC','ORS','PAC','PAI','PAN','PBK','PBP','PC1','PCC','PCE','PCF','PCG','PCM','PCN','PCT','PDB','PDC','PDN','PDR','PDV','PEC','PEN','PEQ','PET','PFL','PGC','PGD','PGI','PGS','PGT','PGV','PHC','PHH','PHP','PHR','PIA','PIC','PID','PIS','PIT','PIV','PJC','PJS','PJT','PKR','PLA','PLC','PLP','PLX','PMB','PMC','PME','PMG','PMJ','PMP','PMS','PMT','PNC','PND','PNG','PNJ','PNT','POB','POM','POS','POT','POV','POW','PPC','PPE','PPG','PPH','PPI','PPP','PPS','PPY','PRC','PRO','PSB','PSC','PSD','PSE','PSG','PSI','PSL','PSN','PSP','PSW','PTB','PTC','PTD','PTE','PTG','PTH','PTI','PTK','PTL','PTM','PTO','PTP','PTS','PTT','PV2','PVA','PVB','PVC','PVD','PVE','PVG','PVH','PVI','PVL','PVM','PVO','PVP','PVR','PVS','PVT','PVV','PVX','PVY','PWS','PX1','PXA','PXC','PXI','PXL','PXM','PXS','PXT','PYU','QBR','QBS','QCC','QCG','QHD','QHW','QLD','QLT','QNC','QNS','QNU','QNW','QPH','QSP','QST','QTC','QTP','RAL','RAT','RBC','RCC','RCD','RCL','RDP','REE','RGC','RHN','RIC','RLC','ROS','RTB','RTH','RTS','S12','S27','S33','S4A','S55','S74','S96','S99','SAB','SAC','SAF','SAL','SAM','SAP','SAS','SAV','SB1','SBA','SBD','SBL','SBM','SBS','SBT','SBV','SC5','SCC','SCD','SCH','SCI','SCJ','SCL','SCO','SCR','SCS','SCY','SD1','SD2','SD3','SD4','SD5','SD6','SD7','SD8','SD9','SDA','SDB','SDC','SDD','SDE','SDG','SDH','SDI','SDJ','SDK','SDN','SDP','SDT','SDU','SDV','SDX','SDY','SEA','SEB','SED','SEP','SFC','SFG','SFI','SFN','SGC','SGD','SGH','SGN','SGO','SGP','SGR','SGS','SGT','SHA','SHB','SHC','SHG','SHI','SHN','SHP','SHS','SHX','SIC','SID','SII','SIV','SJ1','SJC','SJD','SJE','SJF','SJG','SJM','SJS','SKG','SKH','SKV','SLC','SLS','SMA','SMB','SMC','SMN','SMT','SNC','SNZ','SON','SP2','SPA','SPB','SPC','SPD','SPH','SPI','SPM','SPP','SPV','SQC','SRA','SRB','SRC','SRF','SRT','SSC','SSF','SSG','SSI','SSM','SSN','SSU','ST8','STB','STC','STG','STK','STL','STP','STS','STT','STU','STV','SUM','SVC','SVG','SVH','SVI','SVL','SVN','SVT','SWC','SZE','SZL','T12','TA3','TA6','TA9','TAC','TAG','TAP','TAW','TB8','TBC','TBD','TBN','TBT','TBX','TC6','TCD','TCH','TCJ','TCK','TCL','TCM','TCO','TCR','TCS','TCT','TCW','TDA','TDB','TDC','TDG','TDH','TDM','TDN','TDS','TDW','TEC','TEG','TEL','TET','TFC','TGP','TH1','THB','THG','THI','THN','THR','THS','THT','THU','THW','TIE','TIG','TIP','TIS','TIX','TJC','TKC','TKU','TL4','TLD','TLG','TLH','TLP','TLT','TMB','TMC','TMG','TMP','TMS','TMT','TMW','TMX','TNA','TNB','TNC','TND','TNG','TNI','TNM','TNP','TNS','TNT','TNW','TOP','TOT','TPB','TPC','TPH','TPP','TPS','TQN','TRA','TRC','TRS','TRT','TS3','TS4','TS5','TSB','TSC','TSD','TSG','TSJ','TST','TTB','TTC','TTD','TTF','TTG','TTH','TTJ','TTL','TTN','TTP','TTR','TTS','TTT','TTV','TTZ','TUG','TV1','TV2','TV3','TV4','TVA','TVB','TVC','TVD','TVG','TVM','TVN','TVP','TVS','TVT','TVU','TVW','TW3','TXM','TYA','UCT','UDC','UDJ','UEM','UIC','UMC','UNI','UPC','UPH','USC','V11','V12','V15','V21','VAF','VAT','VAV','VBC','VBG','VBH','VC1','VC2','VC3','VC5','VC6','VC7','VC9','VCA','VCB','VCC','VCE','VCF','VCG','VCI','VCM','VCP','VCR','VCS','VCT','VCW','VCX','VDL','VDN','VDP','VDS','VDT','VE1','VE2','VE3','VE4','VE8','VE9','VEC','VEE','VEF','VES','VET','VFC','VFG','VFR','VGC','VGG','VGL','VGP','VGS','VGT','VGV','VHC','VHD','VHF','VHG','VHH','VHL','VIB','VIC','VID','VIE','VIF','VIG','VIH','VIM','VIN','VIP','VIR','VIS','VIT','VIW','VIX','VJC','VKC','VKD','VKP','VLA','VLB','VLC','VLF','VLG','VLP','VLW','VMA','VMC','VMD','VMG','VMI','VMS','VNA','VNB','VNC','VND','VNE','VNF','VNG','VNH','VNI','VNL','VNM','VNN','VNP','VNR','VNS','VNT','VNX','VOC','VOS','VPA','VPB','VPC','VPD','VPG','VPH','VPI','VPK','VPR','VPS','VPW','VQC','VRC','VRE','VRG','VSA','VSC','VSG','VSH','VSI','VSM','VSN','VSP','VST','VT1','VT8','VTA','VTB','VTC','VTG','VTH','VTI','VTJ','VTL','VTM','VTO','VTS','VTV','VTX','VVN','VWS','VXB','WCS','WSB','WSS','WTC','WTN','X18','X20','X77','XHC','XMD','XPH','YBC','YRC','YTC','126IBC','3TAudit','AA','AAAA','AAC','AACA','AACC','AACVN','AAFC','AAS','AASC','AASCN','AASCS','AAT','ABBank','ABBVietNam','ABFM','ABR','ABS','ACAGroup','ACBC','ACBS','ACCCO','ACELife','ACELifeFMC','ACGroup','ACHAU','AChauAudit','Aclii','ACPA','ACSVN','ACVietNam','AEAAudit','AECS','AFCAudit','AFCC','AFCVietNam','AFPAudit','AFVI','AGC','AGD','Agribank','AGRIMECO','AgrimexcoCaMau','AGRITOUR','AGROMAS','AGTourimex','AIA','AIC','AICA','AICapital','Airserco','AISC','AITS','ALC','ALP','AMIC','ANCO','AnGiangDT','AnPhatAudit','AnphatCapital','AnPhu','AnPhuCorp','AnPhuGroup','Anresco','ANZB','AON','APBAudit','ApecAudit','Aplaco','APRest','APSC','APTC','AQN','Artexport','ArtexSaigon','ASCAudit','ASCO','ASCS','ASCSaiGon','AseanAudit','ASIACorp','ASIAGF','ASNAF','ATAAudit','ATAX','ATC','ATICVietnam','ATSC','AUDI','AuditConsult','AuLac','Auto15','AVA','AVICO','Avicon','AVINA','AVS','AzureCity','BacGiang','BachHoa','BachViet','BacNinhWSC','BAF','BAFECO','BAM','BaoBi277','BaoBiDuoc','BaoHoLaoDong','BaoVietBank','BaoVietResort','Barotex','BARUCO','BAS','Baseafood','BBL','BBT','BCEL','BCEL-KT','BCI','BDCC','BDMienTrung','BDOAudit','BDS','BDSDKVN','BDSThanhNien','BecamexCMC','BenhVienGiaoThong','Benthanhhouse','Beta','BeTongHaiAu','BHAAC','BHDienMay','BHS','BHVA','BiaCanTho','BIAQUANGNGAI','BiaSaiGonDongNai','BiaSaiGonHaNam','BiaSaiGonPhuYen','BiaSaiGonQuyNhon','BiaVietHa','BichChi','BikeThongNhat','BinhDien','BinhDinh','BinhTriThien','BIOPHARCO','Biprica','BJC','Bluechipfund','BMJC','BMSC','BNC','BongSen','BOT741','BOTRM','BPMC','Britec','BSMCorp','BTCom','BTL','BTWASECO','BuuDienCM','BVA','BVC','BVF1','BVFED','BVFMC','BVIM','BXBTQuangNinh','BXD','C42','CAA','CADICO','Cafatex','CafeControl','CAGLOBAL','CAMAUWASUCO','CamRanh','CangQuangNinh','CangVatCach','CanHoNamLong','CanhXuanAudit','CaoSuBinhDuong','CAPHEDALAT','CapitaLand','CapNuocCanTho2','CapNuocDongThap','CapNuocNghiaLo','CapNuocYenBai','CapQuang','CapThoatNuocBacLieu','CapVietNhat','Caric','CASEAMEX','CASHIN','CASOCO','CathayLife','CatTuongAudit','Cau14','CauGiay','CauTre','Cavicob','CavicoEc','CavicoGiaoThong','CavicoHaTang','CavicoHC','CavicoVN','CayTrong','CC7','CCN2','CCVN','CemacoHanoi','CFV','CheBauCan','CheBienLamSan','CheBienThucPham','CheLamDong','ChieuSang','CHIN2','ChipSang','ChoLonTourist','ChuanVang','CHUBBLIFE','CHULAIQN','CIC','CIC1','CIC8','CICP1','CIE','CIENCO1','CIENCO4','CIENCO473','CIENCO5','CIENCO503','CIENCO610','CIENCO624','CIENCO8','Ciencoland','Cistra','CIV','CJC203','CK8','CKG','CKI','CKTAYNINH','CLP','CLS','CMCHanoi','CMID','CO122','CoKhiDuyenHai','CoKhiHonGai','CokhiNgoGiaTu','CoKhiOTo32','COMPT','ConDao','CongNgheCao','CongNghiepMasan','CongNghiepPhuYen','CongThanh','CongTrinh134','CongTrinh525','CongTrinhBuuDien','CongTrinhDoThiCanTho','CongTrinhGTDB','CongTrinhHaNoi','CongTy118','CONSTRAD423','CoopBank','COPAC','Coresco','Cosaco','Cosevco','Cosevco1','Cosevco75','COT60','Cotec','CotecAnpha','COXANO','CPAHaNoi','CPAHCM','CPAVietNam','CPC1','CPHACO','CPT','CPVina','CSCJ','CSG','CST124','CT185','CTCCorp','CTE','CTGT','CTIN','CTM','CTV','Cty479','CTYCN2','CVS','CXC','D26','DAB','DaBinhDinh','DaGiayHaiPhong','DaGiayVietNam','DaichiLife','DaiMo','DaiNam','DaiNamAudit','DaiTinAudit','DAN','DaNangXD','DANATEX','DASE','DaTayDo','DatVang','DauTuHaNoi','DBF','DCC','DCPA','DDS','Deloitte','DeltaAgf','DeltaCorp','DeltaTower','DetHaDong','DetHaNoi','DetPhongPhu','DetVinhPhu','DeutscheBank','DFK','DFVN','DHI','DHL','DIAOC3','DIAOC8','DiaOcGiaDinh','DiaOcTanBinh','DIC1','DICThanhBinh','DienLucDaNang','DienLucVietNam','DienNuocHaNoi','DienThuBon','Diginet','DinhThien','DLBD','DLC','DLTHUDUC','DLV','DLX','DMCSouth','DMH','DMTC','DNF','DNG','DNPAudit','DNSE','DNT','DNTD','DNV','Domenal','DONAFOODS','Donatraco','DongABank','DongACapital','DongAnhSteel','DongDuong','DongLong','DongNam','DongPhuongAudit','DongTam','DongTauAnPhu','DongtauVinacomin','DongThang','DongThapTourist','DongTien','DongXanh','DOPHARMA','DoThi18','DothiGialai','DoThiGiaLam','DSVN','DT319','DTF','DTH','DTLAuditing','DTP','DTS','DTSC','DucAnhAudit','DucKhai','DucTanLong','DuLichDaNang','DULICHKHANHHOA','DuLichTaCu','DuLichThanhBinh','DuLichThanhHoa','DuLichThuongMai','DuocDomedic','DuocICA','DuocLieuTW2','DuocNamHa','DuocNgheAn','DuocPham32','DuocTW2','DuocYenBai','DuongBo234','DuongBoDakLak','DuongCanTho','DuongLaNga','DuongSatPhiaNam','DuongSocTrang','DuyHoang07','DVCCBinhDuong','DVD','DVSC','DVVTKHANHHOA','E1SSHN30','EasternAudit','ECC','ECOVIS','Eden','EDL-Gen','EIFMC','EIG','EJung','ELINCO','ENF','ErnstYoung','ETCC','Eurowindow','EVNFC','Eximland','FAC','FACOM','FADACO','Fahasa','Falcon','FanansaFund','FBT','FCB','FENB','FICO','FIS','Foodinco','Formach','FPC','FPTCapital','FPTOnline','FPTRetail','FPTTrading','FRC','FritHue','FSS','Fullhouse','GachThaiBinh','GAFC','GANGTHEPLAOCAI','GaoXKTN','GBS','GCC','GDC','GEC','Gefoseco','Geleximco','Gelimex','Generalimex','Genexim','GENIMEX','Gentraco','Getraco','GFC','GHA','GiaCatAudit','GiaDinhCo','GiaDungPhongPhu','GiaiPhapS2P','GiaoThong','GiaoThong2','GiaoThongHaNoi','GiaoThongQN','GiaSangSteel','GiayDepWEC','GiayHaiDuong','GiayHaNoi','GiayLamSon','GiayLeHoa','GiayThuyKhe','GIDITEXCO','GLS','GocVietAudit','GoldenGate','GPBank','GrantThornton','GreatEastern','GRL','Groupama','GSC','GT6','GTCC','GTI','H22','HAA','Habac','Habaco','Hacc1','HaChau','HACO','HADIC','Hadico6','HAFIC','HaiAn','Haicatex','HaiChau','HaiDuongSeed','HaiPhongMarine','HaiVanNam','HAL','HAMC','HamicoSC','Hanaka','HaNamNinh','Haneco','HanelCo','Hanexim','HangKhong','HANHUD','Hanobaco','HANOIAC','HaNoiFood','HaNoiFund','HaNoiNonNuoc','HaNoiOptic','HaNoiPharma','HaNoiTD','Hanosimex','HANVIFA','HAPHARCO','Hapoco','HAPRO','Haprosimex','HapuIndus','HAPULICO','HARATOUR','HARUTOUR','HASCOM','HATEXCO','HaThanhAudit','HaTienKienGiang','HBB','HBI','HBWA','HCB','HCSC','HDCC1','HDLinvest','HDTAudit','Heco','Hemco','HFIC','HHL','HIC','Hidico','HienLongAudit','HiepPhuoc','HiepThanh','HimLam','HIS','HN184','HNC','HNCC1','HNInvest','HoaBinh','HoaChat','HoaChatCanTho','Hoachatmiennam','HoaChatViSinh','HoaDuocVN','HoaMinhDuc','HoangGiaSCCT','HoangHac','HoangLongAn','HoangThang','HoBon','HoNai','Honeyboy','HongDuc','HongHaAudit','HongHaInvest','HongLeong','HongNam','HOPACO','HopNhat','HopThinh','HPA','HPAuditing','HPHoatHinhVN','HPL','HPR','HPRAILCO','HPS','HPTourism','HQM','HRS','HSAC','HSBC','HSC','HSKAudit','HSM','HSSC','HT2','HTB','HTCJC2','HTS','HTSC','Hudeco','HUDKienGiang','HUEWACO','HUMEXCO','Humic','HungPhu','HuongGiang','HuongGiangCIC','HUTIC','HuuNghiDaNang','HuuNghiNgheAn','HuuToan','HVAC','HVC','HVCapital','HVS','I40','IACAudit','IBFM','ICDLongBinh','ICJC','ICL','ICPC','IDICOICT','IDPCo','IETC','IFCVietNam','IFMC','IGL','ILC','IMEXBINHDINH','IMMA','IMT','Inconess','Indeco','Indovinabank','INEXIM','IneximDaklak','ING','InPhucYen','InSaiGon','InSo7','InTaiChinh','InThongNhat','InTienGiang','Intimex','Intimexco','InTranPhu','InVanHoaPham','INVESTREAL','IPAM','IPC','IRS','ISC','ITOAudit','IVAM','JBC5','JPMorgan','JSC','JSI','KAL','KASJSC','KBT','KCNBacGiang','KGTICJC','KHAFEED','Khaithacda','KhanhTan','KHATOCO','KHOANGSAN4','KhoangSanPhuYen','KhoangSanSongDa','KhoaVietTiep','Kido','KiemNghia','KienGiangPetro','KienHungAudit','KienTrucADC','KIENTUONG','Kigitraco','KIGIWI','KimAnh','KimKhiBacThai','KimLien','KimOanh','KimTuThap','KinhDoLand','KIS','KISUCO','KLM','KLS','KMF','KNITEXIM','KoreaLife','KPC','KPMG','KRESTON','KSC','KSG','KSHCPhuTho','KSIAudit','KSS','KTAChau','KTBX','KTC','KTCVN','KTMienTrung','KTQuocgia','KTSKienGiang','KTV','KTXaydungVN','KVAC','KVS','LacHong','LamDong','LamNghiepBD','LamSankienGiang','LaNga','LangSon','Lanmak','LaoDongQuocTe','LaoVietBank','Lasotra','LCO','LeNinhQB','LeQuanTech','LGM','Liberty','LibertyInsurance','LIBREXCO','Licogi16','Licogi162','Licogi165','Licogi169','Lidovit','LIKSIN','LilamaHN','LilamaPhaLai','LinhGas','LMR','LOGOS','LongTho','LotusIMC','LSG','LungLo3','LuongMyPoultry','LuongSonHoaBinh','LVC','LVN','LVS','LWPC','LXS','MAAC','Machinco1','MAFEQI','MAFPF1','MaiDong','Manulife','ManulifeAM','MAX','MayDapCau','MayDongA','MayDongNai','MayHoangThiLoan','MayLongAn','MayPhuongDong','MaySaiGon2','MaySaiGon3','MaySongHong','MayThangLoi','MayThangLong','MayVietThang','MayVietThinh','Mazars','MBCapital','MBEF1','MBKE','MBVF','Mccons','MCJ','MCL','MCS','MCV','MDB','MDFVINAFOR','MEBI','MECO','MED','Medico','Mediplast','MekongCapital','MEKONIMEX','MHAuditing','MHB','MHBS','MHDAudit','MiaDuongBenTre','MiaDuongNongCong','MiaDuongSonDuong','MienTrung','MIH','MINEXCO','MinhPhuc','MinhVietCapital','MiraeAsset','MIREX','MIWACO','MJC','MKT','MLG','MNB','MobiFone','MOBITECHS','MotorVN','MSB','MSGS','MSI','MTDTNgheAn','MTJ','MyKhe','MyPhamSG','Nakydaco','NamABank','NamChien','NAMCO','NamKhang','NamMuc','NamThi','NamTrieu','NamVietOil','NASC','Natraco','NBN','NBS','NEEM','NgocHy','NgocTung','NgoVietNam','NhaBeTech','NHACANTHO','NhanLuc','NhaSaiGon','NhatMinhAudit','NhatNam','NHDulieu','NhietDienMienBac','NHN','NhoQue1','NHS','NhuNgoc','NHW','NIC','Nicotex','NinhBac','NIS','NISACO','NKD','NLC','NoiHoiVN','NongSanNinhThuan','NSCTech','NSI','NSN','NSP','NTS','Nuocdathuysan','NuocPhuMy','NuocQuangNam','NuocSachLaoCai','Nutifood','NVC','NVN','NVS','OCB','Oceanbank','OCS','OLC','OMC','ORC','OSC','OSCVN','Oseven','OTG','OtoTienGiang','PacificAudit','PACKEXIM','Packsimex','PACO','PAMCO','PAP','PAS','PBC','PCS','PDAC','PeaceTour','PETEC','PETECHIM','PetroKienGiang','PetrolimexNgheTinh','PETROMAT','PETROMEKONG','PetroTrade','PetroVietnam','Petrowaco','PFH','PFI','PFV','PGBank','PGSC','PhanMemDaNang','PhanPhoiVietnam','PhanVu','PHFM','PhimGiaiPhong','PhimThienNgan','PHS','PHT','PhuDat','PhuHung','PhuHungGia','PhuHuuPort','PhuocAnCoffee','PhuongNamSF','PhuongTrang','PhuQuoc','PHUTHOTOURIST','PhuTung','PIDIC','Pisico','PisicoDongAn','PLCO','PMM','PNB','PNS','PNTAudit','Porycoast','POTRACO','PPAP','PPSP','PPWSA','Prevoir','Proconco','PROMEXCO','PROTRADE','PRUBF1','Prudential','PTHTKCNThaiNguyen','PTICC','PVBuilding','PVCI','PVCME','PVcomBank','PVEIC','PVF','PVFCCapital','PVIASSET','PVID','PVQuangNinh','PVSH','PVST','PVThaiNguyen','PWC','PXH','PXK','QCAudit','QNAASC','QNSC','QuangMinh','QuangtruongQT','QuyDauTuVN','QuyNhonPort','QuyVCBF','QuyVietCat','QVA','RauQua1','RECO','REM','REN','RES10','RESCO8','RESCONHA','RHC','RNG','ROSE','RoyalVN','RUID','RUSCO','S64','S91','SAAC','SabecoMienDong','SabecoNTB','SabecoSongHau','SabecoSongTien','SabecoTayNguyen','Sabibeco','SachBinhDuong','SachHoaBinh','SachThanhHoa','Sadaco','SAGEL','SAGRI','Saicom','SAIGON5','SaiGonAir','SaiGonART','SaiGonAuditing','SaiGonCapital','SAIGONIPD','SaiGonNinhChu','SaiGonOptic','SaiGonXanh','SAMCO','SamSet','SanglapAchau','SaoViet','Sapasco','SATICO','SATRA','SatraTayNam','SBBS','SBC','SBF','SBF1','SCB','SCCV','SCFC','SCIC','SCJSC','SDBP','SDF','SDL','SDNT','SDS','SDSE','SeABank','SeafoodF17','SeASecurities','SEC','SEL','Serrano','SFA1','SFA2','SFT','SGAudit','SGB','SGCLInresco','SGDiamond','SGIC','SGNAudit','SGPC','SHBS','SHBVinacomin','SHF','SHINEC','Shinhan','Shinhanvina','SHL','SHV','SJCS','SKS','Smartlink','SME','SMEC','SMVC','SNG','SocTrang','SODIC','SoiTraLy','Sonacon','SonadeziChauDuc','SonBachTuyet','SonChatDeo','SonDaiBang','SongDa','SongDa109','SongDa17','SongDa702','SongDaHoangLien','SongHau','SongHong','SonlaUrenco','SonTra','SOSAL','Sovico','SPS','SPT','SPTAudit','SSAudit','SSGGroup','SSIAM','SSIIMF','SSISCA','SSIVF','SSS','StandardAudit','StandardChartered','STI','STJ','STSC','SunCapital','SunCo','SunGroup','SuThanhHa','SVJ','SVS','SZA','SZB','TAFiCO','TAFM','TAHUE','TaiChinhBIDV','TamViet','TanHung','TANISUGAR','TanLam','TanMai','TanManh','TanPhat','TanTan','TanThanhMy','TanTien','TAPDOANEDX','TAPIOCA','TapPham','TapPhamSG','TARCO','TARUCO','TAS','TauBienHP','TauCuoc','TayHo','TayHoHousing','TayHoQP','TayNinh','TCB','TCBS','TCSC','TCTHUD','TCVN','TDAuditing','TDCorp','TDLA','TechcomCapital','TechGen','Tecserco','TEDI','TediSouth','TEKCAST','TelecomCambodia','THA','ThachBan','ThaiHoaCapNuoc','ThangLong','ThangLong9','ThangLongAudit','ThangLongGTC','ThangLongTSC','ThanhBinh','ThanhCong','ThanhHoaAudit','ThanhHoaPort','ThanhLe','ThanhMinhNhat','ThanhNienMedia','ThanhThanhCong','ThanVinacomin','ThaoNguyenXanh','ThepDinhVu','ThepNinhBinh','ThepSongHong','ThepTanThuan','ThepVanLoi','ThethaoHanoi','ThienHoa','ThienHuong','ThienKim','ThienVietAudit','ThietBiThuyLoi','Thikeco','ThinhLiet','THMilk','ThongTinEIS','ThuanAn','ThuanPhuoc','ThuDo','ThuongMaiGiaLai','ThuThiemDIC','ThuychungAudit','ThuyLoiDienBien','ThuySanKienGiang','THV','TIC','Tico','TienSonThanhHoa','TIIDC','TinHieu','TinHoang','TinNghiaBank','TinNghiaCorp','TinNghiaPetro','Titco','TKR','TKSC','TKTAudit','TLC','TLCF','TLG6','TLMECO','TMD','TMDTKH','TMMNThanhHoa','TMPhuongDong','TMQN','TNY','ToanCau','ToanThinhPhat','Todimax','TonDongA','TourismHCM','TPF','TraBac','TRACIMEXCO','Tracomeco','TRANCINWA','TrangAn','TranPhu','TRI','TRICO','TrieuAn','TriThucDoanhNghiep','TriThucViet','TriTue','TrungDo','TrungTinDuc','TruongSon','TruongSonJSC','TruongThanhAudit','TruongThinhICC','TSM','TSS','TTCExpress','TuvanAPEC','TuyenQuang','TuyPhuoc','TVAC','TVAM','TVFC','TVI','TVMC','TVSI','UAMC','UHY','UIAudit','UICVN','UniCap','Unicons','UnimexHanoi','UNISTARS','Upexim','Utxico','V45','VAAC','VAC','VACA','VACO','VAE','Vafaco','VAMVN','VanDiem','VangAgribank','VangBacNJC','VanPhucGia','VanTaiThuy3','VanTaiTraco','VanTuong','VASC','VASS','Vatuco378','VBI','VBSP','VCAMBF','VCBF','VCBS','VCFC','VCH','VCHF','VCN','VCPA','VCTN','VCV','VDAC','VDAHauGiang','VDB','VDSE','VEAM','Vegetexco','Vegetigi','Vemedim','VEOF','VF2','VFAAudit','VFMVF1','VFMVF4','VFMVFA','VFS','VIA','VIAAudit','Viapco','VIAVietNam','Vibex','Vicopharm','VICOSA','VIDBank','VIDOCO','VienthongBacLieu','VienthongBacMT','VienthongCT','VienthongDaLat','VienThongDongDo','VienThongDongThap','VietABank','VietAnh','VietAuditors','VietBac','Vietbank','Vietbook','VietCapital','VietCapitalBank','VietCeramics','VIETCPA','VietDucAudit','VietDuong','VietHaAudit','VietHaCo','VietHung','VietinbankCapital','Vietland','VietLongAudit','VietMyAudit','VietnamTiger','Vietnamtourism','VietNgaBank','VietNhat','VietNhatFPT','VietSangTao','ViettelGlobal','VietTinAudit','VIETTRANS6','VietTrung','Vietvalue','VietY','VIFON','Vigatexco','VIGECAM','Viger','ViglaceraPB','ViglaceraVanHai','Viha','VIHAAC','Vikhaco','VIKOR','VILACONA','Vimec','VimecMedical','Vinabico','Vinabomi','VINACAFE','VinaCapital','VINACCO','Vinachimex','VinacominLand','Vinaconex17','Vinaconex9','vinaconex91','VinaconexAlphanam','VinaconexQT','VinaconexSG','Vinafood1','VINAFOODII','Vinafor','Vinagame','Vinaglobal','VINALINES','VinalinesNT','VINAMED','Vinamit','VINAMOTOR','VinaSaiGon','VinashinNamThanh','Vinasiam','VINASINO','VinasugarI','VinasugarII','Vinatea','VinatexNamDinh','Vinatour','Vinatranco','VINAWACO','VinaWealth','VinaWind','Vineco5','VinhCuu','Vinhhao','VinhHue','VinhLoi','VinhTuong','VinhYenEnv','Vinphaco','Vipaco','Viptour','VIRASIMEX','VIRESCO','VISE','VISECO','Vitranimex','VITS','VIVASO','Viwaseen1','Viwaseen2','Viwaseen3','VLD','VLFM','VLIF','VLPort','VMCCo','VNAA','VNAAFC','VNAAudit','VNAC','VNAFC','VNASC','VNAudit','VNCAudit','VNCB','VNECO','VNECO12','Vneco6','Vneco7','VNPT','VNPTLAND','VNSC','VNY','VPAudit','VPBS','VPF1','VPF2','VPF3','VPIG','VPJSC','VPL','VQSC','VRTS','VSEC','VSIndustry','VSMS','VTCC','VTCOnline','VTE','VTF','VTK','VTP','VTR','VTRI','VTSC','VTSR','VTSS','VTT','VTVCap','VungTauShip','VVF','WEB','Woori','X78','XayDung14','XayDung204','XayDung24','XayDung40','XayDung720','XaylapGialai','XayLapHoangLien','XayLapHue','XDBD','XDBinhDinh','XDBinhDuong','XDBINHPHUOC','XDCT507','XDHTCanTho','XDTruongThanh','XDVinaconex','XeThaiBinh','XiMangBacGiang','XiMangGiaLai','XiMangKienGiang','XimangTayDo','XMC','XMCOSEVCO','XMTuyenQuang','XNKNinhBinh','XNKNongSan','XNKSaigontourist','XNKThaiBinh','XuatKhauLongAn','YenBai','YSC','ÃTPTTruongAn']
        for macp in macps:
            for i in range(1, 5):
                url = self.base_url.format(macp, i)
                yield scrapy.Request(url, callback=self.parse_taichinh)

    def parse_taichinh(self, response):

        if response.body:
            re_mack = re.match(r'.*&scode=(.*)&bizType.*', response.url)
            i = 0
            for sel in response.xpath("//tr[@class='BR_rowHeader']/td[position() > 1]"):
                i += 1
                item = {}
                item['mack'] = re_mack.group(1)
                item['date'] = sel.xpath('./text()').extract_first('').strip()
                for sel in response.xpath("//tr[@id]"):
                    id = sel.xpath("./@id").extract_first().strip()
                    if re.match(r'\d+', id):
                        item['{}'.format(id)] = response.xpath("//tr[@id='{}']/td[{}]/text()".format(id, i + 2)).extract_first('').strip()

                yield item